#!/usr/bin/env php
<?php

require_once __DIR__.'/../vendor/autoload.php';

function rglob($pattern, $flags = 0) {
  $files = glob($pattern, $flags); 
  foreach (glob(dirname($pattern).'/*', GLOB_ONLYDIR|GLOB_NOSORT) as $dir) {
    $files = array_merge($files, rglob($dir.'/'.basename($pattern), $flags));
  }
  return $files;
}

if (count($argv) > 1) {
  $files = array_slice($argv, 1);
} else {
  $files = rglob(getcwd() . "/specs/*Spec.php");
}

$GLOBALS['speckl'] = [
  'currentBlock' => null,
  'currentPath' => null
];

foreach ($files as $filePath) {
  $GLOBALS['speckl']['currentPath'] = $filePath;
  include $filePath;
}
